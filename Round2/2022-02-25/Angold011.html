<!DOCTYPE html>
<html lang="en"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Angold-4 Organization</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="../../../images/favicon.png" rel="icon">

<link rel="canonical" href=".">
        <meta name="author" content="Angold Wang" />

    <meta property="og:site_name" content="Angold-4" />
<!--     <meta property="og:type" content="article"/> -->
    <meta property="og:title" content="Angold-4 Organization"/>
    <meta property="og:url" content="."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="../../../theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="../../../theme/css/font-awesome.min.css" rel="stylesheet">
<!--     <link href="https://cdnjs.cloudflare.com/ajax/libs/typicons/2.0.9/typicons.min.css" rel="stylesheet"> -->

    <link href="../../../theme/css/pygments/monokai.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../theme/css/style.css" type="text/css"/>

</head>
<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<!-- <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script> -->

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://angold4.org" class="navbar-brand">
<img src="../../../images/logo.png" width="32"/> Angold4            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
			    <li><a href="../../../about.html">About</a>
                            <li><a href="../../../blogs.html">Blogs</a>
                            <li><a href="../../../projects.html">Projects</a>

	    </ul>
            <ul class="nav navbar-nav navbar-right">
                <li> <a title="Youtube" href="https://www.youtube.com/channel/UC3ZAjh2LHhm-FrgxgBtgMzQ" target="_new"><i class="fa fa-youtube"></i> Youtube</a>
		</li>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->


<div class="container">
    <div class="row">
        <div class="col-lg-12">
	<section id="content" class="body">


<h2>A4 Spring 2022 Webinar Series</h2>
<h1>1. MapReduce</h1>
<h5>Host By Angold Wang 02/25/2022</h5>
<h3>Prologue: The Power of Abstraction</h3>
<p><img src="Sources/abstractions.png" alt="abstractions"></p>
<p><strong>These Abstractions let us reason about the behavior of our building blocks, without understanding the implementation details underneath.</strong></p>
<h2>Thread</h2>
<ul>
<li><strong>IO concurrency</strong>
<ul>
<li>While some threads are waiting for I/O, other threads can utilize the CPU resources.</li>
</ul>
</li>
<li><strong>Parallelism</strong>
<ul>
<li>Execute code in parallel on several cores.</li>
</ul>
</li>
<li><strong>Convinence</strong>
<ul>
<li>Relatively simple to programming</li>
</ul>
</li>
</ul>
<h3>User</h3>
<ul>
<li><strong>Most User:</strong> Do not aware / care.</li>
<li><strong>Computer Enthusiast (Geek):</strong> Intel Core i7-12700K, 12 Cores / 20 Threads.</li>
<li><strong>Some Programmers:</strong> Thread vs. Process.</li>
</ul>
<p><img src="Sources/threadprocess.png" alt="threadprocess"></p>
<h3>Programming Language</h3>
<ul>
<li><strong>User-level Threads <code>(N:M)</code></strong>*
<ul>
<li>The kernel is <strong>not aware</strong> of the existence of these threads.</li>
<li>These threads are usually inside 1 or more process, managed by the <strong>Thread Scheduler</strong> of the programming language itself.</li>
<li>Example: <strong>Golang: <code>goroutine</code>.</strong></li>
</ul>
</li>
<li><strong>Kernel-level Threads <code>(1:1)</code></strong>
<ul>
<li>Kernel Scheduling Entity (KSE)</li>
<li>The <strong>minimum-executable</strong> unit in the machine.</li>
<li>Managed by the <strong>OS Scheduler</strong></li>
<li>Example: <strong>C: <code>pthread</code>, Java: <code>java.lang.Thread</code>, C++ <code>std::thread</code></strong>.</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>Thread implementation in Golang - Goroutine</strong></p>
</blockquote>
<p><img src="Sources/gpmgoroutine.png" alt="gpmgoroutine"></p>
<ul>
<li>Each <strong>goroutine</strong> is an independent unit of execution, which have its <strong>unique stack</strong>.</li>
<li>Go's runtime uses resizable, bounded stacks, initially of only 2KB/goroutine. (the runtime grows and shrinks).</li>
<li><strong>Work-stealing</strong> scheduling algorithm.</li>
</ul>
<h3>Operating Systems</h3>
<h4>Threads and Processes are the same !</h4>
<h4>They are all KSEs, and the OS manage them through the OS Scheduler.</h4>
<h2>1. Distributed Systems</h2>
<h3>i. What a Distributed System is?</h3>
<p>A set of cooperating computers that are communicating with each other over network to get some conherent task done.</p>
<ul>
<li><strong>Storiage for big websites</strong></li>
<li><strong>Big data computations (MapReduce)</strong></li>
<li><strong>...</strong></li>
</ul>
<h3>ii. Why People Need a Distributed System?</h3>
<p>Usually, the high-level goal of building a distributed system is to get <strong>scalable speed-up</strong>.</p>
<ol>
<li><strong>&quot;More&quot; Data and Computations</strong></li>
<li><strong>Scalability</strong>
<ul>
<li><strong>2x computers -&gt; 2x throughput (huge win)</strong></li>
<li><strong>Parallelism:</strong> Split the computations into multiple machines. (MapReduce)</li>
<li><strong>High-throughput:</strong> Split the request data into pieces and read them conrurrently from different servers (GFS).</li>
</ul>
</li>
<li>Phsical Reason</li>
<li>Security / Isolated</li>
</ol>
<h3>iii. Challenges</h3>
<ol>
<li>
<p><strong>Fault Tolerate.</strong></p>
<ul>
<li>Big distributed systems: <strong>Failure problems just happen all the time !</strong></li>
<li>The failure has to be built into the design.</li>
<li><strong>Recoverability</strong></li>
</ul>
</li>
<li>
<p><strong>Achieve this Scalability.</strong> (not infinite)</p>
</li>
<li>
<p><strong>Build the Interface.</strong></p>
<ul>
<li>The <strong>&quot;Abstraction&quot;</strong>.</li>
<li>We'd love to be able to build interfaces that look and act just like non-distributed storage and computation systems, but are actually with vast and extremely high performance fault tolerant distributed systems underneath.</li>
</ul>
</li>
<li>
<p><strong>Consistency</strong></p>
<ul>
<li>How to make <strong>Replicas</strong> consistent.</li>
<li>Communication problem (Weak and Strong consistency)</li>
</ul>
</li>
</ol>
<h2>2. MapReduce</h2>
<h3>i. Overview</h3>
<p><strong>Back to 2004, engineers in Google were were looking for a framework that would make it easy for non-specialists to be able to write and run giant distributed computations.</strong></p>
<ul>
<li>Analysis Crawled Documents</li>
<li>Build a index of the web</li>
<li>Sort Web requests logs</li>
<li>...</li>
</ul>
<hr>
<ul>
<li><strong>Multi-hour Computations</strong></li>
<li><strong>Multi-terabyte Datasets</strong></li>
<li><strong>Multi-thousand Machines</strong></li>
</ul>
<hr>
<ul>
<li>How to parallelize the computations ?</li>
<li>How to distribute the data ?</li>
<li>How to handle failures ?</li>
</ul>
<h3>ii. Programming Model</h3>
<p><strong>In a programmer's view, the computation recieves many files, and takes a set of input key/value pairs, then produces a set of output key/value pairs.</strong></p>
<h4>Example: word count</h4>
<p><img src="Sources/mrex.png" alt="mrex"></p>
<h4>Map</h4>
<ul>
<li>Written by the User.</li>
<li>Recieve input files and then produces a set of output key/value pairs.</li>
<li>MR calls <code>map(k, v)</code> for each input file <code>k</code>, and its contains <code>v</code>, produces set of <code>k2</code>, <code>v2</code> &quot; intermediate&quot; data.</li>
</ul>
<pre><code class="language-javascript">map(String key, String value) {
    // key: document name
    // value: document contents
    for each word w in value:
        Emit(w, &quot;1&quot;);
}
</code></pre>
<h4>Reduce</h4>
<ul>
<li>Wirtten by the user.</li>
<li>Recieve key/value pairs from <strong><code>Map</code></strong>.</li>
<li>Then merge together these values with same key to <strong>form a possibly smaller set of values</strong>.</li>
<li>MR gathers all intermediate <code>v2</code> for a given <code>k2</code>, and passes each key + values to a reduce call.</li>
<li>Final outut is set of &lt;k2, v3&gt; pairs from <code>reduce(k2, v2)</code>s.</li>
</ul>
<pre><code class="language-javascript">reduce(k, v)
    // key: a word
    // value: a list of counts
    int result = 0; 
    for each v in values:
        result += ParseInt(v);
    Emit(AsString(result));
</code></pre>
<h4>MapReduce scales well</h4>
<ul>
<li>N &quot;worker&quot; computers get you Nx throughtput.</li>
<li><code>map</code>s can run in parallel, since they don't interact. Same for <code>reduce</code>s.</li>
<li>In that way, you can get more throughtput by buying more computers.</li>
</ul>
<h2>3. Implementation Details</h2>
<h3>i. <a href="https://a4org.github.io/ds/papers/MapReduce/mapreduce.html">Runtime Details (check my notes)</a>:</h3>
<p><img src="Sources/mapreduce.png" alt="mapreduce"></p>
<h3>ii. RPC MapReduce Implementation</h3>
<p><img src="Sources/mapreducerpc.png" alt="mapreducerpc"></p>
<h2>4. Practice Performance</h2>
	</section>
	</div>
    </div>
</div>
<footer>
   <div class="well well-lg" id="footer-well">
      <div class="container">


      <div class="row">
         <div class="col-xs-6">
            <a href="https://angold4.org" title="Angold-4 Organization" class="image-link"><img src="../../../images/logo.png" class="cmudb-logo" /></a>
         </div>
         <div class="col-xs-6">
            <p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p>
        </div>
      </div>
   </div>
   </div>
</footer>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="../../../theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="../../../theme/js/respond.min.js"></script>

<!-- Fix scrolling issues to internal HREFs that get positioned behind navbar -->
<!-- http://stackoverflow.com/questions/10732690/offsetting-an-html-anchor-to-adjust-for-fixed-header -->
<script src="../../../theme/js/href_scroll.js"></script>

<!-- You know what this is and you know what he did to me... -->
<script src="../../../theme/js/tim-kraska-betrayed-me.js"></script>
</body>
</html>
