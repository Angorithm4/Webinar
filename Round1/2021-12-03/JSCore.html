<!DOCTYPE html>
<html lang="en"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Angold-4 Organization</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="../../../images/favicon.png" rel="icon">

<link rel="canonical" href=".">
        <meta name="author" content="Angold Wang" />

    <meta property="og:site_name" content="Angold-4" />
<!--     <meta property="og:type" content="article"/> -->
    <meta property="og:title" content="Angold-4 Organization"/>
    <meta property="og:url" content="."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="../../../theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="../../../theme/css/font-awesome.min.css" rel="stylesheet">
<!--     <link href="https://cdnjs.cloudflare.com/ajax/libs/typicons/2.0.9/typicons.min.css" rel="stylesheet"> -->

    <link href="../../../theme/css/pygments/monokai.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../theme/css/style.css" type="text/css"/>

</head>
<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<!-- <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script> -->

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://angold4.org" class="navbar-brand">
<img src="../../../images/logo.png" width="32"/> Angold4            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
			    <li><a href="../../../about.html">About</a>
                            <li><a href="../../../blogs.html">Blogs</a>
                            <li><a href="../../../projects.html">Projects</a>

	    </ul>
            <ul class="nav navbar-nav navbar-right">
                <li> <a title="Youtube" href="https://www.youtube.com/channel/UC3ZAjh2LHhm-FrgxgBtgMzQ" target="_new"><i class="fa fa-youtube"></i> Youtube</a>
		</li>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->


<div class="container">
    <div class="row">
        <div class="col-lg-12">
	<section id="content" class="body">


<h1>&quot;JavaScript. The Core&quot; Notes</h1>
<h5>Jiawei Wang (Angold-4) Nov 2021</h5>
<ul>
<li><strong>Paper : <a href="http://dmitrysoshnikov.com/ecmascript/javascript-the-core-2nd-edition/">JavaScript. The Core</a></strong></li>
<li><strong>Author : <a href="http://dmitrysoshnikov.com/">Dmitry Soshnikov</a></strong></li>
</ul>
<h2>1. ECMAScript</h2>
<blockquote>
<p><strong>Mocha -&gt; LiveScript -&gt; JavaScript -&gt; ECMA-262 -&gt; ECMAScript -&gt; JavaScript (ECMAScript + DOM + BOM)</strong></p>
</blockquote>
<p>To start from the beginning, <strong>JavaScript</strong> derived its name from <strong>Java</strong> and initially <strong><a href="https://en.wikipedia.org/wiki/Brendan_Eich">Brendan Eich</a></strong> (the Co-founder of Mozilla) was asked to develop a language that resembled Java for the web for his company Netscape.<!-- raw HTML omitted -->
But Eich decided that Java was too complicated and not suitable for web development, <strong>and set out to create a simple language that even a beginner could code in.</strong><!-- raw HTML omitted --></p>
<p>After the language was complete <strong>(Eich &quot;wrote JavaScript in ten days&quot; in 1995)</strong>, the marketing team of Netscape requested Sun to allow them to name it JavaScript as a marketing stunt and hence why most people who have never used JavaScript think it's related to Java.</p>
<p>About a year or two after JavaScript's release in the browser, Microsoft's IE took the language and started making its own implementations such as JScript. At the same time, IE was dominating the market and not long after Netscape had to shut its project.</p>
<p>Before Netscape went down, they decided to start a <strong>standard</strong> that would guide the path of JavaScript, named <strong>ECMAScript</strong>.</p>
<h3>JavaScript is the most popular implementation of the ECMAScript Standard!</h3>
<p>After that Microsoft dominated the scenes but at the same time they weren't improving their product(IE) and hence <strong>Firefox</strong> was born (led by <strong>Eich</strong>) and a whole heap of other browsers such as Chrome, Opera, and they use <strong>JavaScript</strong> as their web scripting language (follow the ECMA Standard).</p>
<h3>Notable JS Engines:</h3>
<!-- raw HTML omitted -->
<h4>V8</h4>
<ul>
<li>From <strong><a href="https://v8.dev/">Google</a></strong></li>
<li>Most Used JS Engine</li>
<li>Used in Chromium-based browsers (Chrome)</li>
</ul>
<!-- raw HTML omitted -->
<h4>SpiderMonkey</h4>
<ul>
<li>From <strong><a href="https://spidermonkey.dev/">Mozilla Foundation</a></strong></li>
<li>The First JS Engine</li>
<li>Used in FireFox</li>
</ul>
<!-- raw HTML omitted -->
<h4>JavaScriptCore From WebKit</h4>
<ul>
<li>From <strong><a href="https://developer.apple.com/documentation/javascriptcore">Apple</a></strong></li>
<li>Used in Safari</li>
</ul>
<h2>2. Prototype</h2>
<h3>i. JavaScript Type</h3>
<blockquote>
<blockquote>
<p><strong>&quot;With the Prototype, almost everything there can also be presented as an object.&quot;</strong></p>
</blockquote>
</blockquote>
<p>Let's start off by looking at <strong>the types</strong>. JavaScript programs manipulate values, and those values all belong to a type.<!-- raw HTML omitted -->
In my opinion, there are only two kinds of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/A_re-introduction_to_JavaScript">types</a> -- <strong>Primitives</strong> and <strong>Objects</strong><!-- raw HTML omitted --></p>
<ul>
<li>
<p><strong>Primitives</strong></p>
<ul>
<li>Number</li>
<li>BigInt</li>
<li>String</li>
<li>Boolean</li>
<li>null</li>
<li>undefined</li>
</ul>
</li>
<li>
<p><strong>Objects</strong></p>
<ul>
<li>Function</li>
<li>Array</li>
<li>Date</li>
<li>RegExp</li>
</ul>
</li>
</ul>
<p><strong>From the implementation-level perspective, all-of these different types can be implement with Object.</strong></p>
<h3>ii. Objects</h3>
<blockquote>
<blockquote>
<p><strong>An object is a collection of properties, and has its own prototype -&gt; either another object or null.</strong></p>
</blockquote>
</blockquote>
<ul>
<li>The <strong>prototype</strong> is a delegation object used to implement <strong>prototype-based inheritance.</strong><!-- raw HTML omitted --></li>
<li>The <strong>prototype</strong> can be set xeplicitly via either the <strong><code>__proto__</code></strong> property, or <strong><code>Object.create</code></strong> method.</li>
</ul>
<pre><code class="language-javascript">let point = { // point is an object
    x: 10,
    y: 20,
};

// either this way
let point3D = {
    z: 30,
    __proto__: point,
}

// or this way
let point3D = Object.create(point);
point3D.z = 30;


console.log(
    point3D.x, // 10
    point3D.y, // 20
    point3D.z, // 30
);

</code></pre>
<p>The <strong>Prototype Chain</strong>, which is a finite chain of object.<!-- raw HTML omitted -->Shows how JavaScript implement <em><strong>inheritance</strong></em> and <em><strong>shared properties</strong></em>:</p>
<p><img src="Sources/prototypechain.png" alt="prototypechain"></p>
<p>If a property is nout found in the object itself, The rule is very simple:</p>
<ul>
<li>There is an attempt to resolve it in the <strong>prototype</strong>; in <strong>the prototype of the prototype</strong>, etc.</li>
<li>After the whole prototype chain is considered, if a property eventually not found, the <strong><code>undefined</code></strong> value is returned.</li>
</ul>
<p>This mechanism is called <strong>Delegation</strong>, or <strong>Dynamic Dispatch</strong>.<!-- raw HTML omitted -->
For those readers who want to have a closer look at the <strong>Prototype Chain</strong>, here is the detail:</p>
<p><img src="Sources/objproto.png" alt="objproto"></p>
<h3>iii. Function</h3>
<p>Every JavaScript function is actually a <strong>Function object</strong><!-- raw HTML omitted -->
or for the implemention level, <strong>A Function is just a object with its native code as a property and inherited from Object</strong></p>
<p><img src="Sources/function.png" alt="function"></p>
<!-- raw HTML omitted -->
<h4>Prototype</h4>
<p>Here comes a question:<!-- raw HTML omitted -->
<strong>We haven't defined any method of object <code>point3D</code>. How does this object have <code>toString()</code> method?</strong><!-- raw HTML omitted --></p>
<p>In <strong><a href="https://github.com/Angorithm4/Webinar/blob/main/2021-12-03/JSCore.md#ii-objects">ii. Objects</a></strong>, we introduced <strong>Dynamic Dispatch</strong>. <!-- raw HTML omitted -->
From that, we can know  <strong><code>toString()</code></strong> method must be defined in the <strong><code>Prototype Chain</code></strong> of object <strong><code>point3D</code></strong>.</p>
<p>So, where are the inherited properties and methods defined?
If you look at the <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a></strong> reference page, you'll see listed in the left hand side a large number of properties and methods â€” many more than the number of inherited members we saw available on the <strong><code>point3D</code></strong> object. Some are inherited, and some aren't â€” why is this?</p>
<p>As mentioned above, the inherited ones are the ones defined on the <strong>prototype</strong> property â€” that is, the ones that begin with <strong><code>Object.prototype</code></strong>, and not the ones that begin with just <strong><code>Object</code></strong>.</p>
<p><strong>The prototype property's value is an object, which is basically a bucket for storing properties and methods that we want to be inherited by objects further down the prototype chain.</strong></p>
<p><img src="Sources/prototype.png" alt="prototype"></p>
<p>if you try the following in your console:</p>
<pre><code class="language-javascript">Object.prototype
</code></pre>
<p>You'll see a large number of methods defined on Object's <strong>prototype</strong> property, which are then available on objects that inherit from Object, as shown earlier.</p>
<p>You'll see other examples of <strong>prototype chain inheritance</strong> all over JavaScript â€” try looking for the methods and properties defined on the prototype of the <strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">String</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date">Date</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a></strong>, and
<strong><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a></strong> global objects.</p>
<h3>iv. Class</h3>
<p><strong>When several objects share the same initial state and behavior, they form a classification.</strong><!-- raw HTML omitted --></p>
<p>A <strong>&quot;Class&quot;</strong> is just a theoretical abstraction, in the implementation-level, it usually represented as a <strong>&quot;constructior function + prototype&quot;</strong> pair. (or even if a object but cumbersome):</p>
<pre><code class="language-javascript">// Constructor Function
function Letter(number) {
    this.number = number;
};

// Prototype
Letter.prototype.getNumber = function() {
    return this.number;
}

let a = new Letter(1);
let b = new Letter(2);
// ... 
let z = new Letter(26);


console.log(
    a.getNumber(); // 1
    b.getNumber(); // 2
    // ...
    z.getNumber(); // 26
);
</code></pre>
<p><img src="Sources/class.png" alt="class"></p>
<p>For <strong>user-convinence</strong> (sometimes you don't want things to become cumbersome).<!-- raw HTML omitted -->
The <strong>Class</strong> Abstraction serves exactly this purpose - being a <strong>syntactic sugar</strong> (a construct which semantically does the same, but in a much nicer syntactic form).<!-- raw HTML omitted -->
It allows creating such multiple objects with the convenient pattern:</p>
<pre><code class="language-javascript">// Class
class Letter2 {
    constructor(number) {
        this.number = number;
    }

    getNumber() {
        return this.number;
    }
}
</code></pre>
<p>While you create a <strong>Class</strong> object, this <strong>syntactic sugar</strong> will help you automatically set the <strong>prototype</strong>.<!-- raw HTML omitted -->
And if you check their prototype, you will find that there is no such big difference - And, both of them are <strong>Object</strong>.</p>
<p><img src="Sources/classfunc.png" alt="classfunc"></p>
<h3>v. Primitives</h3>
<p>At the begining of this <a href="https://github.com/Angorithm4/Webinar/blob/main/2021-12-03/JSCore.md#i-javascript-type">Note</a>. I said:</p>
<blockquote>
<blockquote>
<p><strong>All things in JavaScript can be presented as an Object, but there are something called Primitives that usually do not implement as an Object.</strong></p>
</blockquote>
</blockquote>
<ul>
<li><strong>Primitives</strong> : that is - <strong>Many things that you interact with regularly</strong> (<code>String</code> <code>Number</code> and <code>Boolean</code>).</li>
<li><strong>Reason</strong> : I Believe that is for the <strong>Speed</strong> -- Since most of the time when you create a <strong>Primitive</strong> type variable, you just want to do some calculation with others.<!-- raw HTML omitted -->
Or in other words - <strong>When you create a Primitive type variable, maybe you just want its <code>Value</code>, rather than those &quot;high-level&quot; functions, etc.</strong></li>
</ul>
<pre><code class="language-javascript">var i = 12;
i.p1 = 13;

console.log(i);    // 12
console.log(i.p1); // undefined

</code></pre>
<p>But <strong>primitives</strong> do have <strong>Object Wrappers</strong> (<code>String</code>, <code>Number</code>, <code>Boolean</code>, etc.); these <strong>objects</strong> have methods and properties while the <strong>primitives</strong> do not.<!-- raw HTML omitted -->
But the <strong>primitives</strong> appear to have methods because JavaScript silently creates a <strong>Wrapper Object</strong> when code attempts to access any property of a <strong>primitive</strong>.<!-- raw HTML omitted --></p>
<p>For example, consider the following code:</p>
<pre><code class="language-javascript">var s = 'foo';
var sub = s.substring(1, 2); // sub is now the string &quot;o&quot;
</code></pre>
<p>Behind the scenes, <code>s.substring(1, 2)</code> behaves as if it is performing the following (approximate) steps:</p>
<ol>
<li>Create a wrapper <strong><code>String</code> Object</strong> from <code>s</code>, equivalent to using <code>new String(s)</code>;</li>
<li>Call the <code>substring()</code> method with the appropriate parameters on the <strong><code>String</code> Object</strong> returned by step1;</li>
<li>Dispose of the <strong><code>String</code> Object</strong>;</li>
<li>Return the string (primitive) from step2.</li>
</ol>
<p>And that also explain why we can't access <code>i.p1</code>, while we can assign the property to primitives <code>i</code>.<!-- raw HTML omitted -->
--- <strong>We cannot retrieve them</strong>.</p>
<h2>3. Runtime</h2>
<p>After we understand the basic relationships between ECMAScript <strong>objects</strong>, Let's take a deeper look at JS <strong>runtime system</strong><!-- raw HTML omitted -->
You will see a bunch of <strong>concepts</strong> in the following contents, but remember -- they are just the <strong>Abstraction</strong>, <strong>the things that help you to have a better understanding about what runs underneath.</strong></p>
<h3>i. Execution Stack</h3>
<p>There are severals types of ECMAScript code:</p>
<ul>
<li><strong>Global Code</strong></li>
<li><strong>Function Code</strong></li>
<li><strong>Module Code</strong></li>
<li><strong>......</strong></li>
</ul>
<p>Each code is <strong>evaluated</strong> in its <strong>execution context</strong><!-- raw HTML omitted -->what do I means by <strong>evaluate</strong> is that interprete the code and then execute.</p>
<p>Let's consider a recursive function call:</p>
<pre><code class="language-javascript">function recursive(flag) {
    // Termination Condition
    if (flag == 2) {
        return;
    }
    
    recursive(++flag);
}

// Entry.
recursive(0);
</code></pre>
<p>The following figure shows the runtime of this function:</p>
<p><img src="Sources/es.png" alt="es"></p>
<ul>
<li>The <strong>Execution Context Stack</strong> is a LIFO structure(stack), that used to <strong>maintain control flow and order of execution.</strong></li>
<li>The <strong>Global Context</strong> is always at the bottom of the stack, it is created prior execution of any other context</li>
</ul>
<p>This example may give you a better understanding of <strong>Execution Context:</strong></p>
<pre><code class="language-javascript">function *gen() {  // generator function in javascript
    yield 1;
    return 2;
}

let g = gen();

console.log(
    g.next().value, // 1
    g.next().value, // 2
)
</code></pre>
<p><img src="Sources/ec.png" alt="ec"></p>
<ul>
<li>The <strong><code>yield</code></strong> statement here returns the value to the caller, and pops the context.</li>
<li>One the second <code>next()</code> call, the same context is pushed again onto the stack, and is resumed.</li>
</ul>
<h3>ii. Variable Storiage</h3>
<p><strong>Every execution context has an associated lexical environment -- called Environment</strong>.<!-- raw HTML omitted --></p>
<ul>
<li><strong>Environment can be defined in both ways:</strong></li>
<li>A <strong>structure</strong> used to define associaton between <strong>identifiers</strong> appearing in the context with their <strong>values</strong>.</li>
<li>A <strong>storage</strong> of variables, functions, and classes (Objects) defined in this <strong>Execution Context</strong>.</li>
</ul>
<p>Technically, an environment is a <strong>pair</strong>, consisting of an environment record (an actual storage table which maps identifiers to values), and a <strong>reference to the parent</strong> (which can be <code>null</code>).</p>
<p>Similarly to <strong>Prototype Chain</strong> which we've discussed above. the rule for identifiers resolution is very similar: <!-- raw HTML omitted -->
if a variable is not found in the own environment, there is an attempt to lookup it in the parent environment, in the parent of the parent, and so on â€” until the whole environment chain is considered.</p>
<h4>this</h4>
<p>The <strong><code>this</code></strong> is a special object, the major use-case of <strong><code>this</code></strong> is the class-based <strong>OOP</strong>.<!-- raw HTML omitted -->
For example:</p>
<pre><code class="language-javascript">class Point {
    constructor(x, y) {
        this._x = x;
        this._y = y;
    }

    getX() {
        return this._x;
    }

    getY() {
        return this._y;
    }
}

let p1 = new Point(1, 2);
let p2 = new Point(3, 4);

console.log(
    p1.getX(); // 1
    p2.getX(); // 3
)
</code></pre>
<p>When the <code>getX()</code> method be called by p1, or <strong>the <code>getX()</code> Execution Context being created</strong><!-- raw HTML omitted -->
For this <strong>Execution Context</strong> there will be an <strong>Environment</strong> being created to store local variables and parameters.<!-- raw HTML omitted -->
<strong>In addition, the <code>getX()</code> Environment will implicit gets a <code>this</code> passed into</strong>, which is bound dynamically depending how a function is called.</p>
<pre><code class="language-javascript">console.log(x); // undefined
console.log(y); // throw reference error

var x = 10;
let y = 20;

console.log(this.x); // 10
console.log(this.y); // undefined
console.log(x); // 10
console.log(y); // 20
</code></pre>
<p>At the high-level, the <code>this</code> object is exactly a <code>Binding Object</code>.</p>
<h3>iii. Job Queue</h3>
<h3>iv. JS Engine</h3>
	</section>
	</div>
    </div>
</div>
<footer>
   <div class="well well-lg" id="footer-well">
      <div class="container">


      <div class="row">
         <div class="col-xs-6">
            <a href="https://angold4.org" title="Angold-4 Organization" class="image-link"><img src="../../../images/logo.png" class="cmudb-logo" /></a>
         </div>
         <div class="col-xs-6">
            <p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p>
        </div>
      </div>
   </div>
   </div>
</footer>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="../../../theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="../../../theme/js/respond.min.js"></script>

<!-- Fix scrolling issues to internal HREFs that get positioned behind navbar -->
<!-- http://stackoverflow.com/questions/10732690/offsetting-an-html-anchor-to-adjust-for-fixed-header -->
<script src="../../../theme/js/href_scroll.js"></script>

<!-- You know what this is and you know what he did to me... -->
<script src="../../../theme/js/tim-kraska-betrayed-me.js"></script>
</body>
</html>
